# geom_bar(data = ppt, aes(x = date, y = ppt_scale,
#                          fill = "Daily Precip"),
#          stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Daily Weight Gain (kg/hd/day)",
# limits = c(0,30),
sec.axis = sec_axis(~./coeff, name = "Daily Precipitation (mm)")) +
facet_wrap(~Y, scales = "free_x") +
theme(text = element_text(size = 15, family = 'serif')) +
ggtitle("TRM Daily Weight Gain")
source("D:/APEX data and scripts/R scripts/1605 weight gain/DailyWeightGain_1605_DGZ.R", echo=TRUE)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
max.apex <- max(tgm_dgz_filtered$GZWT)
max.ppt <- max(cper_ppt$RainTotal_mm)
# Coefficient for scaling data
coeff <- max.apex/max.ppt
# Scaling precipitation data
ppt <- cper_ppt %>%
mutate(ppt_scale = RainTotal_mm*coeff) %>%
filter(month(date) %in% c(6:9) & year(date) %in% c(2014:2022)) %>%
rename(Y = year)
ggplot(tgm_dgz_filtered, aes(x = Date, y = DWG)) +
geom_line(aes(color = as.factor(HERD))) +
scale_color_discrete(name = "Herd") +
theme_bw() +
geom_bar(data = ppt, aes(x = date, y = ppt_scale,
fill = "Daily Precip"),
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Daily Weight Gain (kg/hd/day)",
# limits = c(0,30),
sec.axis = sec_axis(~./coeff, name = "Daily Precipitation (mm)")) +
facet_wrap(~Y, scales = "free_x") +
theme(text = element_text(size = 15, family = 'serif')) +
ggtitle("TRM Daily Weight Gain")
ggplot(tgm_dgz_filtered, aes(x = Date, y = DWG)) +
geom_line(aes(color = as.factor(HERD))) +
scale_color_discrete(name = "Herd") +
theme_bw() +
# geom_bar(data = ppt, aes(x = date, y = ppt_scale,
#                          fill = "Daily Precip"),
#          stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Daily Weight Gain (kg/hd/day)",
# limits = c(0,30),
sec.axis = sec_axis(~./coeff, name = "Daily Precipitation (mm)")) +
facet_wrap(~Y, scales = "free_x") +
theme(text = element_text(size = 15, family = 'serif')) +
ggtitle("TRM Daily Weight Gain")
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
agm_agz_base <- read.delim("D:/01-APEX1605_CO_baseline/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Baseline", SD = 0)
library(tidyverse)
agm_agz_base <- read.delim("D:/01-APEX1605_CO_baseline/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Baseline", SD = 0)
agm_agz_pop <- read.delim("APEX1605_CO_20 subareas_dyn plant pop/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Temporal", SD = 0)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM - Copy/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
##### Visualizing scenario comparisons #########################################
## Creating scaled data for having two y axes
max.apex <- min(AGMGain$MeanWT)
max.ppt <- max(cper_ppt$RainTotal_mm)
# Coefficient for scaling data
coeff <- max.apex/max.ppt
# Scaling precipitation data
ppt <- cper_ppt %>%
mutate(ppt_scale = RainTotal_mm*coeff)
## Plot scenario results
ggplot() +
geom_line(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type)) +
geom_point(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type, shape = Type),
size = 3.5) +
geom_errorbar(data = Gain_AGMO,
aes(x = Year, y = MeanWT,
ymin = MeanWT - SD,
ymax = MeanWT + SD,
color = Type),
width = 0.25) +
geom_bar(data = ppt, aes(x = year, y = ppt_scale,
fill = "Annual Precipitation"),
alpha = 0.3,
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Mean Daily Weight Gain (kg/hd/day)",
limits = c(0,1.3),
sec.axis = sec_axis(~./coeff, name = "Annual Precipitation (mm)")) +
theme_bw() +
scale_color_npg() +
ggtitle("CARM")+
scale_x_continuous(breaks = c(2014, 2015, 2016, 2017,
2018, 2019, 2020, 2021, 2022)) +
scale_shape_manual(values = c(16,15,17,18,16))  +
theme(text = element_text(size = 15, family = 'serif')) +
guides(color = guide_legend(title = "Weight Gain Data"),
shape = guide_legend(title = "Weight Gain Data"))
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
View(Gain_simStats)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM - Copy/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
AGMGain_compare <- AGMGain %>%
select(-SD) %>%
filter(Type != "Measured") %>%
merge(Gain_AGMO, by = "Year") %>%
select(-SD, -Type.y) %>%
rename(Simulated = MeanWT.x, Observed = MeanWT.y,
Sim.Type = Type.x)  %>%
mutate(Treatment = "CARM")
Gain_simStats <- rbind(AGMGain_compare, TGMGain_compare) %>%
group_by(Treatment, Sim.Type) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = nrmse(Simulated, Observed, norm = "maxmin")/100,
d = round(d(Simulated, Observed), 3),
pbias = pbias(Simulated, Observed))
source("~/.active-rstudio-document", echo=TRUE)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
library(tidyverse)
library(reshape2)
library(data.table)
library(ggsci)
library(hydroGOF)
setwd("D:/02-APEX1605_spatialtemp/")
source("~/.active-rstudio-document", echo=TRUE)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
##### Visualizing scenario comparisons #########################################
## Creating scaled data for having two y axes
max.apex <- min(AGMGain$MeanWT)
max.ppt <- max(cper_ppt$RainTotal_mm)
# Coefficient for scaling data
coeff <- max.apex/max.ppt
# Scaling precipitation data
ppt <- cper_ppt %>%
mutate(ppt_scale = RainTotal_mm*coeff)
## Plot scenario results
ggplot() +
geom_line(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type)) +
geom_point(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type, shape = Type),
size = 3.5) +
geom_errorbar(data = Gain_AGMO,
aes(x = Year, y = MeanWT,
ymin = MeanWT - SD,
ymax = MeanWT + SD,
color = Type),
width = 0.25) +
geom_bar(data = ppt, aes(x = year, y = ppt_scale,
fill = "Annual Precipitation"),
alpha = 0.3,
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Mean Daily Weight Gain (kg/hd/day)",
limits = c(0,1.3),
sec.axis = sec_axis(~./coeff, name = "Annual Precipitation (mm)")) +
theme_bw() +
scale_color_npg() +
ggtitle("CARM")+
scale_x_continuous(breaks = c(2014, 2015, 2016, 2017,
2018, 2019, 2020, 2021, 2022)) +
scale_shape_manual(values = c(16,15,17,18,16))  +
theme(text = element_text(size = 15, family = 'serif')) +
guides(color = guide_legend(title = "Weight Gain Data"),
shape = guide_legend(title = "Weight Gain Data"))
source("~/.active-rstudio-document", echo=TRUE)
library(tidyverse)
library(reshape2)
library(data.table)
library(ggsci)
library(hydroGOF)
setwd("D:/02-APEX1605_spatialtemp/")
source("~/.active-rstudio-document", echo=TRUE)
## Simulation comparison statistics (model performance)
AGMGain_compare <- AGMGain %>%
select(-SD) %>%
filter(Type != "Measured") %>%
merge(Gain_AGMO, by = "Year") %>%
select(-SD, -Type.y) %>%
rename(Simulated = MeanWT.x, Observed = MeanWT.y,
Sim.Type = Type.x)  %>%
mutate(Treatment = "CARM")
TGMGain_compare <- TGMGain %>%
select(-SD, -Treatment) %>%
filter(Type != "Measured") %>%
merge(Gain_TGMO, by = "Year") %>%
select(-SD, -Type.y) %>%
rename(Simulated = MeanWT.x, Observed = MeanWT.y,
Sim.Type = Type.x)
Gain_simStats <- rbind(AGMGain_compare, TGMGain_compare) %>%
group_by(Treatment, Sim.Type) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = nrmse(Simulated, Observed, norm = "maxmin")/100,
d = round(d(Simulated, Observed), 3),
pbias = pbias(Simulated, Observed))
View(Gain_simStats)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop_NEW/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
##### Visualizing scenario comparisons #########################################
## Creating scaled data for having two y axes
max.apex <- min(AGMGain$MeanWT)
max.ppt <- max(cper_ppt$RainTotal_mm)
# Coefficient for scaling data
coeff <- max.apex/max.ppt
# Scaling precipitation data
ppt <- cper_ppt %>%
mutate(ppt_scale = RainTotal_mm*coeff)
## Plot scenario results
ggplot() +
geom_line(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type)) +
geom_point(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type, shape = Type),
size = 3.5) +
geom_errorbar(data = Gain_AGMO,
aes(x = Year, y = MeanWT,
ymin = MeanWT - SD,
ymax = MeanWT + SD,
color = Type),
width = 0.25) +
geom_bar(data = ppt, aes(x = year, y = ppt_scale,
fill = "Annual Precipitation"),
alpha = 0.3,
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Mean Daily Weight Gain (kg/hd/day)",
limits = c(0,1.3),
sec.axis = sec_axis(~./coeff, name = "Annual Precipitation (mm)")) +
theme_bw() +
scale_color_npg() +
ggtitle("CARM")+
scale_x_continuous(breaks = c(2014, 2015, 2016, 2017,
2018, 2019, 2020, 2021, 2022)) +
scale_shape_manual(values = c(16,15,17,18,16))  +
theme(text = element_text(size = 15, family = 'serif')) +
guides(color = guide_legend(title = "Weight Gain Data"),
shape = guide_legend(title = "Weight Gain Data"))
library(tidyverse)
library(reshape2)
library(data.table)
library(ggsci)
library(hydroGOF)
setwd("D:/02-APEX1605_spatialtemp/")
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop_NEW/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
## Plot scenario results
ggplot() +
geom_line(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type)) +
geom_point(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type, shape = Type),
size = 3.5) +
geom_errorbar(data = Gain_AGMO,
aes(x = Year, y = MeanWT,
ymin = MeanWT - SD,
ymax = MeanWT + SD,
color = Type),
width = 0.25) +
geom_bar(data = ppt, aes(x = year, y = ppt_scale,
fill = "Annual Precipitation"),
alpha = 0.3,
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Mean Daily Weight Gain (kg/hd/day)",
limits = c(0,1.3),
sec.axis = sec_axis(~./coeff, name = "Annual Precipitation (mm)")) +
theme_bw() +
scale_color_npg() +
ggtitle("CARM")+
scale_x_continuous(breaks = c(2014, 2015, 2016, 2017,
2018, 2019, 2020, 2021, 2022)) +
scale_shape_manual(values = c(16,15,17,18,16))  +
theme(text = element_text(size = 15, family = 'serif')) +
guides(color = guide_legend(title = "Weight Gain Data"),
shape = guide_legend(title = "Weight Gain Data"))
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
AGMGain_compare <- AGMGain %>%
select(-SD) %>%
filter(Type != "Measured") %>%
merge(Gain_AGMO, by = "Year") %>%
select(-SD, -Type.y) %>%
rename(Simulated = MeanWT.x, Observed = MeanWT.y,
Sim.Type = Type.x)  %>%
mutate(Treatment = "CARM")
Gain_simStats <- rbind(AGMGain_compare, TGMGain_compare) %>%
group_by(Treatment, Sim.Type) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = nrmse(Simulated, Observed, norm = "maxmin")/100,
d = round(d(Simulated, Observed), 3),
pbias = pbias(Simulated, Observed))
View(Gain_simStats)
library(tidyverse)
library(reshape2)
library(data.table)
library(ggsci)
library(hydroGOF)
setwd("D:/02-APEX1605_spatialtemp/")
agm_agz_base <- read.delim("D:/01-APEX1605_CO_baseline/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Baseline", SD = 0)
agm_agz_pop <- read.delim("APEX1605_CO_20 subareas_dyn plant pop/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Temporal", SD = 0)
agm_agz_var <- read.delim("APEX1605_CO_92 subareas_div/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial", SD = 0)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
agm_agz_base <- read.delim("D:/01-APEX1605_CO_baseline/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Baseline", SD = 0)
agm_agz_pop <- read.delim("APEX1605_CO_20 subareas_dyn plant pop/APEX1605_CO_all20/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014, ID %in% c(1:10)) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Temporal", SD = 0)
agm_agz_var <- read.delim("APEX1605_CO_92 subareas_div/APEX1605_CO_AGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial", SD = 0)
source("~/.active-rstudio-document", echo=TRUE)
source("~/.active-rstudio-document", echo=TRUE)
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop - Copy/APEX1605_CO_AGM - Copy/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
library(tidyverse)
library(reshape2)
library(data.table)
library(ggsci)
library(hydroGOF)
setwd("D:/02-APEX1605_spatialtemp/")
agm_dgz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop - Copy/APEX1605_CO_AGM - Copy/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
AGMGain <- rbind(Gain_AGMO, agm_agz_base, agm_agz_pop, agm_agz_var, agm_dgz_var_pop)
max.apex <- min(AGMGain$MeanWT)
max.ppt <- max(cper_ppt$RainTotal_mm)
# Coefficient for scaling data
coeff <- max.apex/max.ppt
# Scaling precipitation data
ppt <- cper_ppt %>%
mutate(ppt_scale = RainTotal_mm*coeff)
## Plot scenario results
ggplot() +
geom_line(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type)) +
geom_point(data = AGMGain, aes(x = Year, y = MeanWT,
color = Type, shape = Type),
size = 3.5) +
geom_errorbar(data = Gain_AGMO,
aes(x = Year, y = MeanWT,
ymin = MeanWT - SD,
ymax = MeanWT + SD,
color = Type),
width = 0.25) +
geom_bar(data = ppt, aes(x = year, y = ppt_scale,
fill = "Annual Precipitation"),
alpha = 0.3,
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Mean Daily Weight Gain (kg/hd/day)",
limits = c(0,1.3),
sec.axis = sec_axis(~./coeff, name = "Annual Precipitation (mm)")) +
theme_bw() +
scale_color_npg() +
ggtitle("CARM")+
scale_x_continuous(breaks = c(2014, 2015, 2016, 2017,
2018, 2019, 2020, 2021, 2022)) +
scale_shape_manual(values = c(16,15,17,18,16))  +
theme(text = element_text(size = 15, family = 'serif')) +
guides(color = guide_legend(title = "Weight Gain Data"),
shape = guide_legend(title = "Weight Gain Data"))
tgm_agz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop - Copy/APEX1605_CO_TGM - Copy/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
TGMGain <- rbind(Gain_TGMO, tgm_agz_base, tgm_agz_pop, tgm_agz_var, tgm_agz_var_pop)
##### Visualizing scenario comparisons #########################################
## Creating scaled data for having two y axes
max.apex <- min(TGMGain$MeanWT)
max.ppt <- max(cper_ppt$RainTotal_mm)
# Coefficient for scaling data
coeff <- max.apex/max.ppt
# Scaling precipitation data
ppt <- cper_ppt %>%
mutate(ppt_scale = RainTotal_mm*coeff)
## Plot scenario results
ggplot() +
geom_line(data = TGMGain, aes(x = Year, y = MeanWT,
color = Type)) +
geom_point(data = TGMGain, aes(x = Year, y = MeanWT,
color = Type, shape = Type),
size = 3.5) +
geom_errorbar(data = Gain_TGMO,
aes(x = Year, y = MeanWT,
ymin = MeanWT - SD,
ymax = MeanWT + SD,
color = Type),
width = 0.25) +
geom_bar(data = ppt, aes(x = year, y = ppt_scale,
fill = "Annual Precipitation"),
alpha = 0.3,
stat = 'identity') +
scale_fill_manual(name = "Data Type", values = "steelblue") +
scale_y_continuous("Mean Daily Weight Gain (kg/hd/day)",
limits = c(0,1.5),
sec.axis = sec_axis(~./coeff, name = "Annual Precipitation (mm)")) +
theme_bw() +
scale_color_npg() +
ggtitle("TRM")+
scale_x_continuous(breaks = c(2014, 2015, 2016, 2017,
2018, 2019, 2020, 2021, 2022)) +
scale_shape_manual(values = c(16,15,17,18,16))  +
theme(text = element_text(size = 15, family = 'serif')) +
guides(color = guide_legend(title = "Weight Gain Data"),
shape = guide_legend(title = "Weight Gain Data"))
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
tgm_agz_var_pop <- read.delim("APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_TGM/CONUNN_TGM.AGZ",
skip = 10, header = FALSE, sep = "", col.names = name.agz) %>%
filter(Year >= 2014) %>%
group_by(Year) %>%
summarize(MeanWT = mean(WTG)) %>%
mutate(Type = "Spatial+Temporal", SD = 0)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
source("D:/APEX data and scripts/R scripts/1605 weight gain/Avg_DailyWeightGain_plots.R", echo=TRUE)
View(Gain_simStats)
