plot
dev.off()
plot <- list(biomass, new_column)
pdf('C:/APEX data and scripts/Data/plot.pdf', width=10, height=10)
plot
dev.off()
plot <- list(biomass, new_column)
pdf('C:/APEX data and scripts/Data/SeanD_92 subareas_plot.pdf', width=10, height=10)
plot
dev.off()
path <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_all92/CONUNN_TGM.cag"
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha', STL, STD) %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(AB_DDMkg_ha = 'AB_DDMkg/ha')
library(tidyverse)
path <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_all92/CONUNN_TGM.cag"
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha', STL, STD) %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(AB_DDMkg_ha = 'AB_DDMkg/ha')
library(tidyverse)
library(data.table)
path <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_all92/CONUNN_TGM.cag"
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha', STL, STD) %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(AB_DDMkg_ha = 'AB_DDMkg/ha')
PastureID_sa92 <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
biomass_cageSim_spatVar_v02 <- left_join(biomass_cageSim_spatVar, PastureID_sa92,
by = "ID")
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
filter(month(Date) == 8 & day(Date) == 12,
Treatment == "TRM") %>%
mutate(Plot = as.factor(Plot),
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha)
write.csv(biomass_cageSim_spatVar_v03, "C:/APEX data and scripts/Data/SeanD_TRM sim biomass_11132024.csv")
View(biomass_cageSim_spatVar_v03)
## Import observed data
observed_data <- read.csv("C:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Widecln_attr_2024-03-26.csv",
header = T) %>%
select(2:13,17) %>%
mutate(CSAG = AG, WSPG = (BOBU+WSPG), CSPG = C3PG) %>%
dplyr::rename(Year = YearSampled) %>%
select(1:5,9:15) %>%
subset(Year %in% c(2014:2018)) %>%
pivot_longer(cols = c(FORB:SS, CSAG:CSPG),
names_to = "APEXcodeFG", values_to = "v1") %>%
group_by(Year,Pasture,Plot, Transect, Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1))
## Summarizing observational data to plot level
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
change_plant_codes <- function(df) {
df %>%
mutate(APEXcodeFG = gsub("SS", "SSHB", APEXcodeFG),
APEXcodeFG = gsub("CSAG", "VUOC", APEXcodeFG),
APEXcodeFG = gsub("FORB", "FRB3", APEXcodeFG),
Treatment = gsub("TGM", "TRM", Treatment),
Treatment = gsub("AGM", "CARM", Treatment),
Pasture = gsub("NH", "10S", Pasture))
}
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized, PastureID_sa92, by = c("Pasture","Plot","Treatment"))
View(observed_data_summarized)
View(observed_data_summarized)
observed_data <- read.csv("C:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Widecln_attr_2024-03-26.csv",
header = T) %>%
select(2:13,17) %>%
mutate(CSAG = AG, WSPG = (BOBU+WSPG), CSPG = C3PG) %>%
dplyr::rename(Year = YearSampled) %>%
select(1:5,9:15) %>%
subset(Year %in% c(2014:2018)) %>%
pivot_longer(cols = c(FORB:SS, CSAG:CSPG),
names_to = "APEXcodeFG", values_to = "v1") %>%
group_by(Year,Pasture,Plot, Transect, Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1))
## Summarizing observational data to plot level
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 12, sep = "-")),
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized, PastureID_sa92, by = c("Pasture","Plot","Treatment"))
View(observed_data_summarized)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92, by = c("Pasture","Plot","Treatment")) %>%
filter(Treatment == "TRM")
colnames(observed_data_summarized)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92) %>%
filter(Treatment == "TRM")
View(observed_data_summarized)
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 12, sep = "-")),
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92,
by = c("ID", "Pasture", "Plot","Treatment",
"Ecosite", "Block", "CARM_name")) %>%
filter(Treatment == "TRM")
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 12, sep = "-")),
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92,
by = c("Pasture", "Plot","Treatment")) %>%
filter(Treatment == "TRM")
colnames(observed_data_summarized)
colnames(biomass_cageSim_spatVar_v03)
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block"))
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 12, sep = "-")),
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92,
by = c("Pasture", "Plot","Treatment")) %>%
filter(Treatment == "TRM") %>%
mutate(Plot = as.factor(Plot))
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block"))
View(Biomass)
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block", "CARM_name"))
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92,
by = c("Pasture", "Plot","Treatment")) %>%
filter(Treatment == "TRM") %>%
mutate(Plot = as.factor(Plot)) %>%
rename(CPNM = APEXcodeFG)
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 12, sep = "-")),
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized,
PastureID_sa92,
by = c("Pasture", "Plot","Treatment")) %>%
filter(Treatment == "TRM") %>%
mutate(Plot = as.factor(Plot)) %>%
rename(CPNM = APEXcodeFG)
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block", "CARM_name",
"CPNM"))
View(Biomass)
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block", "CARM_name",
"Treatment", "CPNM"))
View(Biomass)
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block", "CARM_name",
"Treatment", "CPNM", "Date"))
View(Biomass)
write.csv(Biomass, "C:/APEX data and scripts/Data/SeanD_compare biomass.csv")
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot))
View(biomass_cageSim_spatVar_v03)
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot))
View(biomass_cageSim_spatVar_v03)
## Summarizing data into pasture
Biomass <- left_join(observed_data_summarized, biomass_cageSim_spatVar_v03,
by = c("ID", "Pasture", "Plot","Ecosite", "Block", "CARM_name",
"Treatment", "CPNM", "Date"))
View(Biomass)
write.csv(biomass_cageSim_spatVar_v03, "C:/APEX data and scripts/Data/SeanD_TRM sim biomass_11132024.csv")
biomass <- ggplot(data = biomass_cageSim_spatVar_v03)+
geom_line(aes(x = Date, y = Biomass, color = Plot)) +
facet_grid(Pasture ~ CPNM,
scales = "free_y") +
ylab(expression(paste("STL + STD (kg ", " ha" ^-1,")"))) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
new_column <- ggplot(data = biomass_cageSim_spatVar_v03)+
geom_line(aes(x = Date, y = AB_DDMkg_ha, color = Plot)) +
facet_grid(Pasture ~ CPNM,
scales = "free_y") +
ylab(expression("AB_DDMkg_ha")) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
biomass <- ggplot(data = biomass_cageSim_spatVar_v03)+
geom_line(aes(x = Date, y = Biomass, color = Plot)) +
facet_grid(Pasture ~ CPNM,
scales = "free_y") +
ylab(expression(paste("STL + STD (kg ", " ha" ^-1,")"))) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
new_column <- ggplot(data = biomass_cageSim_spatVar_v03)+
geom_line(aes(x = Date, y = acc_DDM, color = Plot)) +
facet_grid(Pasture ~ CPNM,
scales = "free_y") +
ylab(expression("AB_DDMkg_ha")) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
plot <- list(biomass, new_column)
pdf('C:/APEX data and scripts/Data/SeanD_92 subareas_plot.pdf', width=10, height=10)
plot
ggplot(data = biomass_cageSim_spatVar_v03)+
geom_line(aes(x = Date, y = acc_DDM, color = Plot)) +
facet_grid(Pasture ~ CPNM,
scales = "free_y") +
ylab(expression("AB_DDMkg_ha")) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
View(biomass_cageSim_spatVar_v03)
View(biomass_cageSim_spatVar_v03)
path <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_all92/CONUNN_TGM.cag"
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha', STL, STD) %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(AB_DDMkg_ha = 'AB_DDMkg/ha')
PastureID_sa92 <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
biomass_cageSim_spatVar_v02 <- left_join(biomass_cageSim_spatVar, PastureID_sa92,
by = "ID")
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot))
View(biomass_cageSim_spatVar_v03)
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha') %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(DDMkg_ha = 'AB_DDMkg/ha')
PastureID_sa92 <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
biomass_cageSim_spatVar_v02 <- left_join(biomass_cageSim_spatVar, PastureID_sa92,
by = "ID")
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-AB_DDMkg_ha)
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-'AB_DDMkg_ha')
colnames(biomass_cageSim_spatVar_v03)
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-AB_DDMkg_ha)
path <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_all92/CONUNN_TGM.cag"
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha') %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(DDMkg_ha = 'AB_DDMkg/ha')
PastureID_sa92 <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
biomass_cageSim_spatVar_v02 <- left_join(biomass_cageSim_spatVar, PastureID_sa92,
by = "ID")
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-AB_DDMkg_ha)
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(AB_DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot))
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-DDMkg_ha)
View(biomass_cageSim_spatVar_v03)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM), color = Plot) +
facet_grid(CPNM ~ Pasture)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM, color = Plot)) +
facet_grid(CPNM ~ Pasture)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM)) +
facet_grid(CPNM ~ Pasture)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM))
library(tidyverse)
library(data.table)
path <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_all92/CONUNN_TGM.cag"
biomass_cageSim_spatVar <- fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
select(ID, Y, M, D, CPNM, 'AB_DDMkg/ha') %>%
filter(Y %in% c(2014:2018)) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
rename(DDMkg_ha = 'AB_DDMkg/ha')
PastureID_sa92 <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
biomass_cageSim_spatVar_v02 <- left_join(biomass_cageSim_spatVar, PastureID_sa92,
by = "ID")
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, PCPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-DDMkg_ha)
# Filter and calculate the accumulation
biomass_cageSim_spatVar_v03 <- biomass_cageSim_spatVar_v02 %>%
# Filter to only include data up to August 12th of each year
filter(Date <= ymd(paste(Y, "08", "12", sep = "-"))) %>%
group_by(Y, ID, CPNM) %>%
# Calculate the cumulative sum for each year and ID
mutate(acc_DDM = cumsum(DDMkg_ha)) %>%
# Filter to only keep rows where the date is August 12th of each year
filter(month(Date) == 8 & day(Date) == 12, Treatment == "TRM") %>%
ungroup() %>%
mutate(Plot = as.factor(Plot)) %>%
select(-DDMkg_ha)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM))
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM)) +
facet_grid(~CPNM)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM)) +
facet_grid(Pasture~CPNM)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM, color = Plot)) +
facet_grid(Pasture~CPNM)
ggplot(biomass_cageSim_spatVar_v03) +
geom_line(aes(x = Date, y = acc_DDM, color = Plot)) +
facet_grid(Pasture~CPNM) +
theme_bw()
View(biomass_cageSim_spatVar_v03)
# (Optional) Save the processed data to a CSV file for further analysis or sharing
write.csv(biomass_cageSim_spatVar_v03, "C:/APEX data and scripts/Data/SeanD_TRM sim biomass_11132024.csv")
