Treatment %in% c("CARM","TRM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
TS = NA) %>%
merge(PastureID, by = c("Pasture","Treatment")) %>%
select(-Year)
## Summarizing data into pasture
Biomass_pasture <- rbind(obv23_20sa, SimBiom02) %>%
group_by(Date, Pasture, Treatment, Type, FGcode) %>%
dplyr::summarise(MeankgPerHa = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS)) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(Mean = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS))
Biomass_pasture_se <- rbind(obv23_20sa, SimBiom02) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else if(num.sa == 92) {
pathAGM <- "./Cage Biomass Simulation/03-APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTRM <- "./Cage Biomass Simulation/03-APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
SimBiom_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2023) & CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3", "SSHB")) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS, TS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
Treatment = "CARM") %>%
select(-c(Y:D))
SimBiom_TRM <- fread(pathTRM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2023) & CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3", "SSHB")) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS, TS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
Treatment = "TRM") %>%
select(-c(Y:D))
## Importing reference information
PastureID <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
SimBiom02_AGM <- merge(SimBiom_AGM, PastureID,
by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(FGcode = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
SimBiom02_TRM <- merge(SimBiom_TRM, PastureID,
by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(FGcode = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
## Adding observational data
obv23_92sa <- obv23 %>%
group_by(Year, Pasture, Plot, Transect, Treatment, FGcode) %>%
summarize(kgPerHa = mean(kgPerHa)) %>%
group_by(Year, Pasture, Plot, Treatment, FGcode) %>%
summarize(MeankgPerHa = mean(kgPerHa)) %>%
subset(FGcode %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("CARM","TRM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
TS = NA)  %>%
merge(PastureID, by = c("Pasture","Plot","Treatment")) %>%
select(-Year)
## Summarizing data into pasture
Biomass_pasture <- rbind(obv23_92sa, SimBiom02_AGM, SimBiom02_TRM) %>%
group_by(Date, Pasture, Treatment, Type, FGcode) %>%
dplyr::summarise(MeankgPerHa = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS)) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(Mean = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS))
Biomass_pasture_se <- rbind(obv23_92sa, SimBiom02_AGM, SimBiom02_TRM) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else{
print("incompatible number of subareas")
}
Biomass_pasture <- merge(Biomass_pasture, Biomass_pasture_se)
Biomass_pasture$FGcode <- gsub("FRB3","FORB",Biomass_pasture$FGcode)
Biomass_pasture$FGcode <- gsub("VUOC","CSAG",Biomass_pasture$FGcode)
Biomass_pasture <- Biomass_pasture %>%
filter(FGcode %in% c("CSPG", "FORB", "CSAG", "WSPG"))
return(Biomass_pasture)
}
## Spatial Variability
Biomass_var_graze <- bm_cag_combine(num.sa = 92,
direct = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div") %>%
mutate(Sim.Type = "Simulated: spatial variability")
## Spatial + Temporal Variability
Biomass_var_pop_graze <- bm_cag_combine(num.sa = 92,
direct = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop") %>%
mutate(Sim.Type = "Simulated: spatial+temporal variability")
### COMPARE ACROSS SCENARIOS @ GRAZING TREATMENT LEVEL
Biomass_comb_graze <- rbind(Biomass_base_graze,
Biomass_var_graze,
# Biomass_pop_graze,
Biomass_var_pop_graze)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, APEXcodeFG) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2),
d = round(d(Simulated, Observed), 2),
pbias = pbias(Simulated, Observed, dec = 2))
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, FGcode) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2),
d = round(d(Simulated, Observed), 2),
pbias = pbias(Simulated, Observed, dec = 2))
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
View(graze_compare)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD, -WS, -TS) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
### COMPARE ACROSS SCENARIOS @ GRAZING TREATMENT LEVEL
Biomass_comb_graze <- rbind(Biomass_base_graze,
Biomass_var_graze,
# Biomass_pop_graze,
Biomass_var_pop_graze)
View(Biomass_comb_graze)
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD, -WS, -TS) %>%
filter(month(Date) == 8, day(Date) == 6)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD, -WS, -TS) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
obv23 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Longcln_attr_2024-03-26.csv", header = T) %>%
select(2:14) %>%
filter(YearSampled %in% c(2014:2023)) %>%
dplyr::rename(Year = YearSampled)
View(obv23)
obv23$FGcode <- gsub(pattern = "AG", replacement = "CSAG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "C3PG", replacement = "CSPG", x = obv23$FGcode)
obv23$FGcode <- gsub("SS","SSHB",obv23$FGcode)
obv23$FGcode <- gsub("CSAG","VUOC",obv23$FGcode)
obv23$FGcode <- gsub("FORB","FRB3",obv23$FGcode)
obv23$Treatment <- gsub(pattern = "AGM", replacement = "CARM", x = obv23$Treatment)
obv23$Treatment <- gsub(pattern = "TGM", replacement = "TRM", x = obv23$Treatment)
obv23$Pasture <- gsub("NH", "10S", obv23$Pasture)
obv23 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Longcln_attr_2024-03-26.csv", header = T) %>%
select(2:14) %>%
filter(YearSampled %in% c(2014:2023)) %>%
dplyr::rename(Year = YearSampled)
obv23$FGcode <- gsub(pattern = "AG", replacement = "CSAG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "C3PG", replacement = "CSPG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "SS", replacement = "SSHB",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "CSAG",replacement = "VUOC",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "FRB3", replacement = "FORB",obv23$FGcode)
obv23$Treatment <- gsub(pattern = "AGM", replacement = "CARM", x = obv23$Treatment)
obv23$Treatment <- gsub(pattern = "TGM", replacement = "TRM", x = obv23$Treatment)
obv23$FGcode <- gsub(pattern = "VUOC",replacement = "CSAG",obv23$FGcode)
obv23 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Longcln_attr_2024-03-26.csv", header = T) %>%
select(2:14) %>%
filter(YearSampled %in% c(2014:2023)) %>%
dplyr::rename(Year = YearSampled)
obv23$FGcode <- gsub(pattern = "AG", replacement = "CSAG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "C3PG", replacement = "CSPG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "SS", replacement = "SSHB",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "VUOC",replacement = "CSAG",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "FRB3", replacement = "FORB",obv23$FGcode)
obv23$Treatment <- gsub(pattern = "AGM", replacement = "CARM", x = obv23$Treatment)
obv23$Treatment <- gsub(pattern = "TGM", replacement = "TRM", x = obv23$Treatment)
obv23$Pasture <- gsub("NH", "10S", obv23$Pasture)
obv23 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Longcln_attr_2024-03-26.csv", header = T) %>%
select(2:14) %>%
filter(YearSampled %in% c(2014:2023)) %>%
dplyr::rename(Year = YearSampled)
# obv23$FGcode <- gsub(pattern = "AG", replacement = "CSAG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "C3PG", replacement = "CSPG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "SS", replacement = "SSHB",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "VUOC",replacement = "CSAG",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "FRB3", replacement = "FORB",obv23$FGcode)
obv23$Treatment <- gsub(pattern = "AGM", replacement = "CARM", x = obv23$Treatment)
obv23$Treatment <- gsub(pattern = "TGM", replacement = "TRM", x = obv23$Treatment)
obv23$Pasture <- gsub("NH", "10S", obv23$Pasture)
obv23 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Longcln_attr_2024-03-26.csv", header = T) %>%
select(2:14) %>%
filter(YearSampled %in% c(2014:2023)) %>%
dplyr::rename(Year = YearSampled)
obv23$FGcode <- gsub(pattern = "AG", replacement = "CSAG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "VUOC",replacement = "CSAG",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "C3PG", replacement = "CSPG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "SS", replacement = "SSHB",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "FRB3", replacement = "FORB",obv23$FGcode)
obv23$Treatment <- gsub(pattern = "AGM", replacement = "CARM", x = obv23$Treatment)
obv23$Treatment <- gsub(pattern = "TGM", replacement = "TRM", x = obv23$Treatment)
obv23$Pasture <- gsub("NH", "10S", obv23$Pasture)
obv23$FGcode <- gsub(pattern = "BOBU", replacement = "WSPG",obv23$FGcode)
bm_cag_combine <- function(num.sa = 20, direct){
setwd(direct)
### Observational data
obv23 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Longcln_attr_2024-03-26.csv", header = T) %>%
select(2:14) %>%
filter(YearSampled %in% c(2014:2023)) %>%
dplyr::rename(Year = YearSampled)
obv23$FGcode <- gsub(pattern = "AG", replacement = "CSAG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "VUOC",replacement = "CSAG",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "C3PG", replacement = "CSPG", x = obv23$FGcode)
obv23$FGcode <- gsub(pattern = "SS", replacement = "SSHB",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "FRB3", replacement = "FORB",obv23$FGcode)
obv23$FGcode <- gsub(pattern = "BOBU", replacement = "WSPG",obv23$FGcode)
obv23$Treatment <- gsub(pattern = "AGM", replacement = "CARM", x = obv23$Treatment)
obv23$Treatment <- gsub(pattern = "TGM", replacement = "TRM", x = obv23$Treatment)
obv23$Pasture <- gsub("NH", "10S", obv23$Pasture)
obv23 <- obv23 %>%
group_by(Year, Pasture, Plot, Transect, Distance, Treatment, FGcode) %>%
dplyr::summarize(kgPerHa = sum(kgPerHa)) # combining WSPG + BOBU
### Simulated Data
if(num.sa == 20){
path <- "./Cage Biomass Simulation/03-APEX1605_CO_all20_cagebm/CONUNN_TGM.cag"
## Importing simulated data
SimBiom <- fread(path, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2023) & CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3", "SSHB")) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS, TS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
Treatment = ifelse(ID %in% c(1:10), "TRM", "CARM")) %>%
select(-c(Y:D))
## Importing reference information
PastureID <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv") %>%
mutate(Treatment = ifelse(Treatment == "TGM", "TRM", "CARM"))
## Cleaning simulated data
SimBiom02 <- merge(SimBiom, PastureID,
by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(FGcode = CPNM,
MeankgPerHa = Biomass)  %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
## Adding observational data
obv23_20sa <- obv23 %>%
group_by(Year, Pasture, Plot, Transect, Treatment, FGcode) %>%
summarize(kgPerHa = mean(kgPerHa)) %>%
group_by(Year, Pasture, Plot, Treatment, FGcode) %>%
summarize(kgPerHa = mean(kgPerHa)) %>%
group_by(Year, Pasture, Treatment, FGcode) %>%
dplyr::summarize(MeankgPerHa = mean(kgPerHa)) %>%
subset(FGcode %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("CARM","TRM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
TS = NA) %>%
merge(PastureID, by = c("Pasture","Treatment")) %>%
select(-Year)
## Summarizing data into pasture
Biomass_pasture <- rbind(obv23_20sa, SimBiom02) %>%
group_by(Date, Pasture, Treatment, Type, FGcode) %>%
dplyr::summarise(MeankgPerHa = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS)) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(Mean = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS))
Biomass_pasture_se <- rbind(obv23_20sa, SimBiom02) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else if(num.sa == 92) {
pathAGM <- "./Cage Biomass Simulation/03-APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTRM <- "./Cage Biomass Simulation/03-APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
SimBiom_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2023) & CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3", "SSHB")) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS, TS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
Treatment = "CARM") %>%
select(-c(Y:D))
SimBiom_TRM <- fread(pathTRM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2023) & CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3", "SSHB")) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS, TS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
Treatment = "TRM") %>%
select(-c(Y:D))
## Importing reference information
PastureID <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
SimBiom02_AGM <- merge(SimBiom_AGM, PastureID,
by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(FGcode = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
SimBiom02_TRM <- merge(SimBiom_TRM, PastureID,
by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(FGcode = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
## Adding observational data
obv23_92sa <- obv23 %>%
group_by(Year, Pasture, Plot, Transect, Treatment, FGcode) %>%
summarize(kgPerHa = mean(kgPerHa)) %>%
group_by(Year, Pasture, Plot, Treatment, FGcode) %>%
summarize(MeankgPerHa = mean(kgPerHa)) %>%
subset(FGcode %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("CARM","TRM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
TS = NA)  %>%
merge(PastureID, by = c("Pasture","Plot","Treatment")) %>%
select(-Year)
## Summarizing data into pasture
Biomass_pasture <- rbind(obv23_92sa, SimBiom02_AGM, SimBiom02_TRM) %>%
group_by(Date, Pasture, Treatment, Type, FGcode) %>%
dplyr::summarise(MeankgPerHa = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS)) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(Mean = mean(MeankgPerHa),
WS = mean(WS),
TS = mean(TS))
Biomass_pasture_se <- rbind(obv23_92sa, SimBiom02_AGM, SimBiom02_TRM) %>%
group_by(Date,Treatment,Type,FGcode) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else{
print("incompatible number of subareas")
}
Biomass_pasture <- merge(Biomass_pasture, Biomass_pasture_se)
Biomass_pasture$FGcode <- gsub("FRB3","FORB",Biomass_pasture$FGcode)
Biomass_pasture$FGcode <- gsub("VUOC","CSAG",Biomass_pasture$FGcode)
Biomass_pasture <- Biomass_pasture %>%
filter(FGcode %in% c("CSPG", "FORB", "CSAG", "WSPG"))
return(Biomass_pasture)
}
## Spatial Variability
Biomass_var_graze <- bm_cag_combine(num.sa = 92,
direct = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div") %>%
mutate(Sim.Type = "Simulated: spatial variability")
## Spatial + Temporal Variability
Biomass_var_pop_graze <- bm_cag_combine(num.sa = 92,
direct = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop") %>%
mutate(Sim.Type = "Simulated: spatial+temporal variability")
### COMPARE ACROSS SCENARIOS @ GRAZING TREATMENT LEVEL
Biomass_comb_graze <- rbind(Biomass_base_graze,
Biomass_var_graze,
Biomass_var_pop_graze)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD, -WS, -TS) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
View(graze_compare)
Biomass_base_graze <- bm_cag_combine(num.sa = 20,
direct = "D:/01-APEX1605_CO_baseline/")  %>%
mutate(Sim.Type = "Simulated: no variability")
## Spatial Variability
Biomass_var_graze <- bm_cag_combine(num.sa = 92,
direct = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div") %>%
mutate(Sim.Type = "Simulated: spatial variability")
## Spatial + Temporal Variability
Biomass_var_pop_graze <- bm_cag_combine(num.sa = 92,
direct = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop") %>%
mutate(Sim.Type = "Simulated: spatial+temporal variability")
### COMPARE ACROSS SCENARIOS @ GRAZING TREATMENT LEVEL
Biomass_comb_graze <- rbind(Biomass_base_graze,
Biomass_var_graze,
Biomass_var_pop_graze)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD, -WS, -TS) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, FGcode) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2),
d = round(d(Simulated, Observed), 2),
pbias = pbias(Simulated, Observed, dec = 2))
View(graze_simStats)
## color blind friendly palette
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
## Plot across grazing treatment*plant functional group
ggplot()+
geom_ribbon(aes(x = Date, ymin = Mean - SD, ymax = Mean + SD),
subset(Biomass_base_graze, Type %in% "Simulated"),
alpha = 0.15) +
geom_line(aes(x = Date, y = Mean, color = Sim.Type),
subset(Biomass_comb_graze, Type %in% "Simulated"),
linewidth = 1) +
geom_point(aes(x = Date, y = Mean, color = "Observed"),
subset(Biomass_base_graze, Type == "Observed"),
size = 1.75, stroke = 0.7) +
geom_errorbar(aes(x = Date, ymin = Mean - SD, ymax = Mean + SD,
color = "Observed"),
subset(Biomass_base_graze, Type %in% "Observed"),
linewidth = 0.7, width = 100) +
facet_grid(APEXcodeFG ~ Treatment, scales = "free_y") +
ylab(expression(paste("Ungrazed Standing Biomass (kg ", " ha" ^-1,")"))) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
scale_color_manual(values = cbbPalette,
name = "Forage Production Data") +
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
ggplot()+
geom_ribbon(aes(x = Date, ymin = Mean - SD, ymax = Mean + SD),
subset(Biomass_base_graze, Type %in% "Simulated"),
alpha = 0.15) +
geom_line(aes(x = Date, y = Mean, color = Sim.Type),
subset(Biomass_comb_graze, Type %in% "Simulated"),
linewidth = 1) +
geom_point(aes(x = Date, y = Mean, color = "Observed"),
subset(Biomass_base_graze, Type == "Observed"),
size = 1.75, stroke = 0.7) +
geom_errorbar(aes(x = Date, ymin = Mean - SD, ymax = Mean + SD,
color = "Observed"),
subset(Biomass_base_graze, Type %in% "Observed"),
linewidth = 0.7, width = 100) +
facet_grid(FGcode ~ Treatment, scales = "free_y") +
ylab(expression(paste("Ungrazed Standing Biomass (kg ", " ha" ^-1,")"))) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
scale_color_manual(values = cbbPalette,
name = "Forage Production Data") +
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
obv22 <- read.csv("D:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Widecln_attr_2024-03-26.csv", header = T)
View(obv22)
source("~/GitHub/APEX_spatial-temp-var/1605 biomass/biomass_1605_CageBiomassRun.R", echo=TRUE)
source("~/GitHub/APEX_spatial-temp-var/1605 biomass/biomass_1605_CageBiomassRun.R", echo=TRUE)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, FGcode) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2),
d = round(d(Simulated, Observed), 2),
pbias = pbias(Simulated, Observed, dec = 2))
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, APEXcodeFG) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2),
d = round(d(Simulated, Observed), 2),
pbias = pbias(Simulated, Observed, dec = 2))
## color blind friendly palette
cbbPalette <- c("#000000", "#E69F00", "#56B4E9", "#009E73",
"#F0E442", "#0072B2", "#D55E00", "#CC79A7")
## Plot across grazing treatment*plant functional group
ggplot()+
geom_ribbon(aes(x = Date, ymin = Mean - SD, ymax = Mean + SD),
subset(Biomass_base_graze, Type %in% "Simulated"),
alpha = 0.15) +
geom_line(aes(x = Date, y = Mean, color = Sim.Type),
subset(Biomass_comb_graze, Type %in% "Simulated"),
linewidth = 1) +
geom_point(aes(x = Date, y = Mean, color = "Observed"),
subset(Biomass_base_graze, Type == "Observed"),
size = 1.75, stroke = 0.7) +
geom_errorbar(aes(x = Date, ymin = Mean - SD, ymax = Mean + SD,
color = "Observed"),
subset(Biomass_base_graze, Type %in% "Observed"),
linewidth = 0.7, width = 100) +
facet_grid(APEXcodeFG ~ Treatment, scales = "free_y") +
ylab(expression(paste("Ungrazed Standing Biomass (kg ", " ha" ^-1,")"))) +
xlab("Date (Month-Year)")+
scale_x_date(date_breaks = "1 year", date_labels = "%m-%y",expand = c(0,10))+
scale_color_manual(values = cbbPalette,
name = "Forage Production Data") +
theme_bw() +
theme(text = element_text(size = 15, family = 'serif'),
axis.text.x = element_text(angle = 90),
panel.spacing = unit(0.75, "lines"))
source("~/GitHub/APEX_spatial-temp-var/1605 biomass/biomass_1605_CageBiomassRun.R", echo=TRUE)
