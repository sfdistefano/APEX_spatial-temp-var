abs_ioa_sd <- function(observed, predicted) {
# Mean of observed values
obs_mean <- mean(observed)
# Numerator: sum of squared differences between predicted and observed
numerator <- sum((predicted - observed)^2)
# Denominator: sum of absolute differences between predicted and observed mean + observed and observed mean
denominator <- sum((abs(predicted - obs_mean) + abs(observed - obs_mean))^2)
# Calculate Absolute IOA
ioa <- 1 - (numerator / denominator)
return(ioa)
}
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, APEXcodeFG) %>%
summarize(d = round(abs_ioa_sd(observed = Observed,
predicted = Simulated), 2),
pbias = pbias(Simulated, Observed, dec = 2),
rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2))
View(Biomass_comb_ecosite)
View(Biomass_comb_graze)
View(test)
View(ecosite_simStats)
write.csv(graze_compare, "C:/APEX data and scripts/APEX outputs/graze_trt_compare_obsSim.csv")
View(Biomass_comb_graze)
observed_data <- read.csv("C:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Widecln_attr_2024-03-26.csv",
header = T) %>%
select(2:13,17) %>%
mutate(CSAG = AG, WSPG = (BOBU+WSPG)/2, CSPG = C3PG) %>%
dplyr::rename(Year = YearSampled) %>%
select(1:5,9:15) %>%
subset(Year %in% c(2014:2018)) %>%
pivot_longer(cols = c(FORB:SS, CSAG:CSPG),
names_to = "APEXcodeFG", values_to = "v1") %>%
group_by(Year,Pasture,Plot, Transect, Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1))
View(observed_data)
import_and_filter_data <- function(path, years = c(2014:2018)) {
fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
filter(Y %in% years) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
select(-c(Y:M, D))
}
clean_biomass_data <- function(simulated_biomass) {
simulated_biomass %>%
merge(PastureID, by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(APEXcodeFG = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
}
pathTRM <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
simulated_biomass_TRM <- import_and_filter_data(pathTRM) %>%
mutate(Treatment = "TRM")
View(simulated_biomass_TRM)
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
simulated_biomass02_TRM <- clean_biomass_data(simulated_biomass_TRM)
View(simulated_biomass02_TRM)
test <- simulated_biomass02_TRM %>% filter(month(Date) == 8,
day(Date) == 6)
View(test)
View(observed_data)
observed_data_clean <- observed_data %>%
group_by(Year,Pasture,Plot,Treatment,APEXcodeFG) %>%
summarize(MeankgPerHa = mean(v1)) %>%
filter(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM")) %>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
View(observed_data_clean)
observed_data_clean <- observed_data %>%
group_by(Year,Pasture,Plot,Treatment,APEXcodeFG) %>%
summarize(MeankgPerHa = mean(v1)) %>%
filter(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM")) %>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year) %>%
filter(Treatment == "TGM")
test_merge <- merge(test, observed_data_clean,
by = c("Pasture", "Plot", "APEXcodeFG"))
View(test_merge)
test_merge <- merge(test, observed_data_clean,
by = c("Pasture", "Plot", "APEXcodeFG", "Date"))
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare.csv")
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_spatVar.csv")
pathTRM <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/Cage Biomass Simulation/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
simulated_biomass_TRM <- import_and_filter_data(pathTRM) %>%
mutate(Treatment = "TRM")
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
simulated_biomass02_TRM <- clean_biomass_data(simulated_biomass_TRM)
test <- simulated_biomass02_TRM %>% filter(month(Date) == 8,
day(Date) == 6)
test_merge <- merge(test, observed_data_clean,
by = c("Pasture", "Plot", "APEXcodeFG", "Date"))
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_spatTempVar.csv")
change_plant_codes <- function(df) {
df %>%
mutate(APEXcodeFG = gsub("SS", "SSHB", APEXcodeFG),
APEXcodeFG = gsub("CSAG", "VUOC", APEXcodeFG),
APEXcodeFG = gsub("FORB", "FRB3", APEXcodeFG),
Treatment = gsub("TGM", "TRM", Treatment),
Treatment = gsub("AGM", "CARM", Treatment),
Pasture = gsub("NH", "10S", Pasture))
}
observed_data_clean <- change_plant_codes(observed_data_clean)
pathTRM <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/Cage Biomass Simulation/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
simulated_biomass_TRM <- import_and_filter_data(pathTRM) %>%
mutate(Treatment = "TRM")
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
simulated_biomass02_TRM <- clean_biomass_data(simulated_biomass_TRM)
test <- simulated_biomass02_TRM %>% filter(month(Date) == 8,
day(Date) == 6)
test_merge <- merge(test, observed_data_clean,
by = c("Pasture", "Plot", "APEXcodeFG", "Date"))
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_spatTempVar.csv")
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_spatTempVar_allTRM.csv")
observed_data <- read.csv("C:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Widecln_attr_2024-03-26.csv",
header = T) %>%
select(2:13,17) %>%
mutate(CSAG = AG, WSPG = (BOBU+WSPG)/2, CSPG = C3PG) %>%
dplyr::rename(Year = YearSampled) %>%
select(1:5,9:15) %>%
subset(Year %in% c(2014:2018)) %>%
pivot_longer(cols = c(FORB:SS, CSAG:CSPG),
names_to = "APEXcodeFG", values_to = "v1") %>%
group_by(Year,Pasture,Plot, Transect, Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1))
observed_data_clean <- observed_data %>%
group_by(Year,Pasture,Plot,Treatment,APEXcodeFG) %>%
summarize(MeankgPerHa = mean(v1)) %>%
filter(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM")) %>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year) %>%
filter(Treatment == "TGM")
change_plant_codes <- function(df) {
df %>%
mutate(APEXcodeFG = gsub("SS", "SSHB", APEXcodeFG),
APEXcodeFG = gsub("CSAG", "VUOC", APEXcodeFG),
APEXcodeFG = gsub("FORB", "FRB3", APEXcodeFG),
Treatment = gsub("TGM", "TRM", Treatment),
Treatment = gsub("AGM", "CARM", Treatment),
Pasture = gsub("NH", "10S", Pasture))
}
observed_data_clean <- change_plant_codes(observed_data_clean)
import_and_filter_data <- function(path, years = c(2014:2018)) {
fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
filter(Y %in% years) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
select(-c(Y:M, D))
}
clean_biomass_data <- function(simulated_biomass) {
simulated_biomass %>%
merge(PastureID, by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(APEXcodeFG = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
}
pathTRM <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/Cage Biomass Simulation/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
simulated_biomass_TRM <- import_and_filter_data(pathTRM) %>%
mutate(Treatment = "TRM")
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
simulated_biomass02_TRM <- clean_biomass_data(simulated_biomass_TRM)
test <- simulated_biomass02_TRM %>% filter(month(Date) == 8,
day(Date) == 6)
test_merge <- merge(test, observed_data_clean,
by = c("Pasture", "Plot", "APEXcodeFG", "Date"))
View(test_merge)
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_spatTempVar_allTRM.csv")
pathTRM <- "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/Cage Biomass Simulation/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
simulated_biomass_TRM <- import_and_filter_data(pathTRM) %>%
mutate(Treatment = "TRM")
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
simulated_biomass02_TRM <- clean_biomass_data(simulated_biomass_TRM)
test <- simulated_biomass02_TRM %>% filter(month(Date) == 8,
day(Date) == 6)
test_merge <- merge(test, observed_data_clean,
by = c("Pasture", "Plot", "APEXcodeFG", "Date"))
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_spatVar_allTRM.csv")
bm_cag_combine <- function(num.sa = 20, direct, division = "Pasture"){
setwd(direct)
# Helper function for importing data
import_and_filter_data <- function(path, years = c(2014:2018)) {
fread(path, fill = TRUE, skip = 9, header = TRUE) %>%
filter(Y %in% years) %>%
select(ID, Y, M, D, CPNM, STL, STD, WS) %>%
mutate(Date = ymd(paste(Y, M, D, sep = "-")),
ID = as.integer(ID)) %>%
select(-c(Y:M, D))
}
# Helper function for data cleaning
clean_biomass_data <- function(simulated_biomass) {
simulated_biomass %>%
merge(PastureID, by = c("ID", "Treatment")) %>%
mutate(Type = "Simulated",
STL_kgha = STL * 1000,
STD_kgha = STD * 1000,
Biomass = STL_kgha + STD_kgha) %>%
dplyr::rename(APEXcodeFG = CPNM,
MeankgPerHa = Biomass) %>%
select(-c(STL:STD), -c(STL_kgha:STD_kgha))
}
# Helper function for changing plant codes to match between observational and simulated data
change_plant_codes <- function(df) {
df %>%
mutate(APEXcodeFG = gsub("SS", "SSHB", APEXcodeFG),
APEXcodeFG = gsub("CSAG", "VUOC", APEXcodeFG),
APEXcodeFG = gsub("FORB", "FRB3", APEXcodeFG),
Treatment = gsub("TGM", "TRM", Treatment),
Treatment = gsub("AGM", "CARM", Treatment),
Pasture = gsub("NH", "10S", Pasture))
}
## Import observed data
observed_data <- read.csv("C:/APEX data and scripts/Data/CPER Biomass/CARM_Biomass_Widecln_attr_2024-03-26.csv",
header = T) %>%
select(2:13,17) %>%
mutate(CSAG = AG, WSPG = (BOBU+WSPG)/2, CSPG = C3PG) %>%
dplyr::rename(Year = YearSampled) %>%
select(1:5,9:15) %>%
subset(Year %in% c(2014:2018)) %>%
pivot_longer(cols = c(FORB:SS, CSAG:CSPG),
names_to = "APEXcodeFG", values_to = "v1") %>%
group_by(Year,Pasture,Plot, Transect, Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1))
if(num.sa == 20){
path <- "./Cage Biomass Simulation/APEX1605_CO_all20_cagebm/CONUNN_TGM.cag"
## Importing simulated data
simulated_biomass <- import_and_filter_data(path) %>%
mutate(Treatment = ifelse(ID %in% 1:10, "TRM", "CARM"))
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv") %>%
mutate(Treatment = ifelse(Treatment == "TGM", "TRM", "CARM"))
## Cleaning simulated data
simulated_biomass02 <- clean_biomass_data(simulated_biomass)
## Summarizing observed data
observed_data_summarized <- observed_data %>%
group_by(Year,Pasture,Plot, Transect, Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1)) %>%
group_by(Year,Pasture,Plot,Treatment,APEXcodeFG) %>%
summarize(v1 = mean(v1)) %>%
group_by(Year,Pasture,Treatment,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
filter(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM")) %>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized, PastureID, by = c("Pasture", "Treatment"))
## Summarizing data into pasture
Biomass <- rbind(observed_data_summarized, simulated_biomass02) %>%
group_by(Date, Pasture, Treatment, Type, APEXcodeFG) %>%
dplyr::summarise(MeankgPerHa = mean(MeankgPerHa)) %>%
group_by(Date,Treatment,Type,APEXcodeFG) %>%
dplyr::summarise(Mean = mean(MeankgPerHa))
Biomass_se <- rbind(observed_data_summarized, simulated_biomass02) %>%
group_by(Date,Treatment,Type,APEXcodeFG) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else if(num.sa == 92) {
pathAGM <- "./Cage Biomass Simulation/APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTRM <- "./Cage Biomass Simulation/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
# Importing simulated data
simulated_biomass_AGM <- import_and_filter_data(pathAGM) %>%
mutate(Treatment = "CARM")
simulated_biomass_TRM <- import_and_filter_data(pathTRM) %>%
mutate(Treatment = "TRM")
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
## Cleaning reference information
simulated_biomass02_AGM <- clean_biomass_data(simulated_biomass_AGM)
simulated_biomass02_TRM <- clean_biomass_data(simulated_biomass_TRM)
if(division == "Pasture") {
## Summarizing observational data
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
## Adding pasture information
observed_data_summarized <- merge(observed_data_summarized, PastureID, by = c("Pasture","Plot","Treatment"))
## Summarizing data into pasture
Biomass <- rbind(observed_data_summarized, simulated_biomass02_AGM, simulated_biomass02_TRM) %>%
group_by(Date, Pasture, Treatment, Type, APEXcodeFG) %>%
dplyr::summarise(MeankgPerHa = mean(MeankgPerHa)) %>%
group_by(Date,Treatment,Type,APEXcodeFG) %>%
dplyr::summarise(Mean = mean(MeankgPerHa))
Biomass_se <- rbind(observed_data_summarized, simulated_biomass02_AGM, simulated_biomass02_TRM) %>%
group_by(Date,Treatment,Type,APEXcodeFG) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else if (division == "Ecosite") {
## Cleaning observational data
observed_data_clean <- observed_data %>%
group_by(Year,Pasture,Plot,Treatment,APEXcodeFG) %>%
summarize(MeankgPerHa = mean(v1)) %>%
filter(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM")) %>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_clean <- change_plant_codes(observed_data_clean)
# changing one pasture name
observed_data_clean$Pasture <- gsub("NH", "10S", observed_data_clean$Pasture)
## Adding pasture information
observed_data_clean <- merge(observed_data_clean, PastureID, by = c("Pasture", "Treatment", "Plot"))
## Summarizing data into pasture
Biomass <- rbind(observed_data_clean, simulated_biomass02_AGM, simulated_biomass02_TRM) %>%
group_by(Date, Ecosite, Treatment, Type, APEXcodeFG) %>%
dplyr::summarise(Mean = mean(MeankgPerHa))
Biomass_se <- rbind(observed_data_clean, simulated_biomass02_AGM, simulated_biomass02_TRM) %>%
group_by(Date,Ecosite,Type,APEXcodeFG) %>%
dplyr::summarise(SE = sd(MeankgPerHa)/sqrt(length(MeankgPerHa)),
SD = sd(MeankgPerHa))
} else {
stop("Invalid division type. Choose 'Pasture' or 'Ecosite'")
}
} else {
stop("incompatible number of subareas")
}
Biomass <- merge(Biomass, Biomass_se)
Biomass$APEXcodeFG <- gsub("FRB3","FORB",Biomass$APEXcodeFG)
Biomass$APEXcodeFG <- gsub("VUOC","CSAG",Biomass$APEXcodeFG)
Biomass <- Biomass %>%
filter(APEXcodeFG %in% c("CSPG", "FORB", "CSAG", "WSPG", "SSHB"))
return(Biomass)
}
## Baseline
Biomass_base_graze <- bm_cag_combine(num.sa = 20,
direct = "C:/01-APEX1605_CO_baseline/")  %>%
mutate(Sim.Type = "Simulated: no variability") %>%
filter(Treatment == "TRM")
## Spatial Variability
Biomass_var_graze <- bm_cag_combine(num.sa = 92,
direct = "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div") %>%
mutate(Sim.Type = "Simulated: spatial variability") %>%
filter(Treatment == "TRM")
## Spatial + Temporal Variability
Biomass_var_pop_graze <- bm_cag_combine(num.sa = 92,
direct = "C:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop") %>%
mutate(Sim.Type = "Simulated: spatial+temporal variability") %>%
filter(Treatment == "TRM")
#### COMPARE ACROSS SCENARIOS @ GRAZING TREATMENT LEVEL
Biomass_comb_graze <- rbind(Biomass_base_graze,
Biomass_var_graze,
Biomass_var_pop_graze
)
## Simulation stats
graze_compare <- Biomass_comb_graze %>%
select(-SE, -SD) %>%
filter(month(Date) == 8, day(Date) == 6) %>%
pivot_wider(names_from = Type, values_from = Mean)
graze_simStats <- graze_compare %>%
group_by(Treatment, Sim.Type, APEXcodeFG) %>%
summarise(rmse = round(rmse(Simulated, Observed), 2),
nrmse = round(nrmse(Simulated, Observed, norm = "maxmin")/100, 2),
d = round(d(Simulated, Observed), 2),
pbias = pbias(Simulated, Observed, dec = 2))
View(graze_compare)
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,Plot,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
path <- "C:/01-APEX1605_CO_baseline//Cage Biomass Simulation/APEX1605_CO_all20_cagebm/CONUNN_TGM.cag"
## Importing simulated data
simulated_biomass <- import_and_filter_data(path) %>%
mutate(Treatment = ifelse(ID %in% 1:10, "TRM", "CARM"))
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv") %>%
mutate(Treatment = ifelse(Treatment == "TGM", "TRM", "CARM"))
## Cleaning simulated data
simulated_biomass02 <- clean_biomass_data(simulated_biomass)
test <- simulated_biomass02 %>% filter(month(Date) == 8,
day(Date) == 6)
test_merge <- merge(test, observed_data_summarized,
by = c("Pasture", "APEXcodeFG", "Date"))
test <- simulated_biomass02 %>% filter(month(Date) == 8,
day(Date) == 6)
test_merge <- merge(test, observed_data_summarized,
by = c("Pasture", "APEXcodeFG", "Date"))
test <- simulated_biomass02 %>% filter(month(Date) == 8,
day(Date) == 6) %>%
filter(Treatment == "TRM")
test_merge <- merge(test, observed_data_summarized,
by = c("Pasture", "APEXcodeFG", "Date"))
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_noVar_allTRM.csv")
## Summarizing observational data
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
observed_data_summarized <- observed_data %>%
group_by(Year,Treatment, Pasture,APEXcodeFG) %>%
dplyr::summarize(MeankgPerHa = mean(v1)) %>%
subset(APEXcodeFG %in% c("WSPG", "CSPG", "SS", "FORB", "CSAG") &
Treatment %in% c("AGM","TGM"))%>%
mutate(Type = "Observed",
Date = ymd(paste(Year, 8, 6, sep = "-")),
WS = NA,
APEXcodeFG=as.character(APEXcodeFG)) %>%
ungroup(Year) %>%
select(-Year)
# Changing plant codes
observed_data_summarized <- change_plant_codes(observed_data_summarized)
# changing one pasture name
observed_data_summarized$Pasture <- gsub("NH", "10S", observed_data_summarized$Pasture)
path <- "C:/01-APEX1605_CO_baseline//Cage Biomass Simulation/APEX1605_CO_all20_cagebm/CONUNN_TGM.cag"
## Importing simulated data
simulated_biomass <- import_and_filter_data(path) %>%
mutate(Treatment = ifelse(ID %in% 1:10, "TRM", "CARM"))
## Importing reference information
PastureID <- read.csv("C:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv") %>%
mutate(Treatment = ifelse(Treatment == "TGM", "TRM", "CARM"))
## Cleaning simulated data
simulated_biomass02 <- clean_biomass_data(simulated_biomass)
test <- simulated_biomass02 %>% filter(month(Date) == 8,
day(Date) == 6) %>%
filter(Treatment == "TRM")
test_merge <- merge(test, observed_data_summarized,
by = c("Pasture", "APEXcodeFG", "Date"))
write.csv(test_merge, "C:/APEX data and scripts/APEX outputs/test_output_compare_noVar_allTRM.csv")
