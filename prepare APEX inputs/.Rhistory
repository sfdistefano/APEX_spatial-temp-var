PlantPop_trt <- merge(PlantPop, PastureID_sa20, by = "ID") %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
## Visualize plant pop differences
ggplot(PlantPop_trt, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop") +
ylab("Herbaceous Plant Pop (Basal Area %)")
pathAGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
PastureID_sa92 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
PlantPop_spat_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()
PlantPop_spat_TGM <- fread(pathTGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()
PlantPop_spat <- rbind(PlantPop_spat_AGM, PlantPop_spat_TGM)
PastureID_sa92 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
PlantPop_yr_spat <- merge(PlantPop_spat, PastureID_sa92, by = "ID") %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
PlantPop_spat_TGM <- fread(pathTGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()  %>%
mutate(Treatment = "TRM")
PlantPop_spat <- rbind(PlantPop_spat_AGM, PlantPop_spat_TGM)
PlantPop_spat_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct() %>%
mutate(Treatment = "CARM")
PlantPop_spat_TGM <- fread(pathTGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()  %>%
mutate(Treatment = "TRM")
PlantPop_spat <- rbind(PlantPop_spat_AGM, PlantPop_spat_TGM)
PlantPop_yr_spat <- merge(PlantPop_spat, PastureID_sa92, by = c("ID", "Treatment")) %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
ggplot(PlantPop_yr_spat, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)")
ggplot(PlantPop_yr_spat, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Spatial Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)")
## Visualize plant pop differences
ggplot(PlantPop_yr_base, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)")
# Add in reference info
PlantPop_yr_base <- merge(PlantPop_base, PastureID_sa20, by = "ID") %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
path <- "D:/01-APEX1605_CO_baseline/APEX1605_CO_all20_cagebm/CONUNN_TGM.cag"
PlantPop_base <- fread(path, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()
# Add in reference info
PlantPop_yr_base <- merge(PlantPop_base, PastureID_sa20, by = "ID") %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
## Visualize plant pop differences
ggplot(PlantPop_yr_base, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)")
ggplot(PlantPop_yr_spat, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Spatial Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)")
# Step 3: Spatial + Temporal Variability simulation
pathAGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
PlantPop_spatTemp_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct() %>%
mutate(Treatment = "CARM")
PlantPop_spatTemp_TGM <- fread(pathTGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()  %>%
mutate(Treatment = "TRM")
PlantPop_spatTemp <- rbind(PlantPop_spatTemp_AGM, PlantPop_spatTemp_TGM)
PlantPop_yr_spatTemp <- merge(PlantPop_spatTemp, PastureID_sa92, by = c("ID", "Treatment")) %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
ggplot(PlantPop_yr_spatTemp, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Spatial + TemporalSimulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)")
source("D:/APEX data and scripts/R scripts/prepare APEX inputs/prepare_CANOPY input_92 subareas.R", echo=TRUE)
write.csv(canopy.input, "D:/APEX data and scripts/APEX inputs/input_CANOPY.DAT_subareas92_05072024.csv")
source("D:/APEX data and scripts/R scripts/check plant pop.R", echo=TRUE)
ggplot(PlantPop_yr_base, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)") +
ylim(0,30)
ggplot(PlantPop_yr_spat, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Spatial Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)") +
ylim(0,30)
ggplot(PlantPop_yr_spatTemp, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Spatial + Temporal Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)") +
ylim(0,30)
source("D:/APEX data and scripts/R scripts/prepare APEX inputs/prepare_CANOPY input_20 subareas.R", echo=TRUE)
library(tidyverse)
library(reshape2)
library(data.table)
library(hydroGOF)
OPC_col.names <-  c("ID","Year_num", "Month", "Day", "Till", "Tractor",
"apex.code", "JX7", "HERD", "OPV1", "OPV2", "OPV3", "apex.input",
"OPV6", "OPV7")
OPC.files_sa20 <- list.files(path = "D:/01-APEX1605_CO_baseline/APEX1605_CO_all20",
pattern = "\\.OPC$")
OPC.files_sa92_AGM <- list.files(path = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_AGM",
pattern = "\\.OPC$")
OPC.files_sa92_TGM <- list.files(path = "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_TGM",
pattern = "\\.OPC$")
setwd("D:/01-APEX1605_CO_baseline/APEX1605_CO_all20")
OPC.input_sa20 <- lapply(OPC.files_sa20, function(file) {
fread(file, skip = 2, nrows = 6,
sep = " ", fill = TRUE)
})
setwd("D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_AGM")
OPC.input_sa92_AGM <- lapply(OPC.files_sa92_AGM, function(file) {
fread(file, skip = 2, nrows = 6,
sep = " ", fill = TRUE)
})
setwd("D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_TGM")
OPC.input_sa92_TGM <- lapply(OPC.files_sa92_TGM, function(file) {
fread(file, skip = 2, nrows = 6,
sep = " ", fill = TRUE)
})
OPC.input_df_sa20 <- rbindlist(OPC.input_sa20, idcol = TRUE) %>%
setNames(OPC_col.names) %>%
select(ID, apex.code, apex.input)
OPC.input_df_sa92_AGM <- rbindlist(OPC.input_sa92_AGM, idcol = TRUE) %>%
setNames(OPC_col.names) %>%
select(ID, apex.code, apex.input)
OPC.input_df_sa92_TGM <- rbindlist(OPC.input_sa92_TGM, idcol = TRUE) %>%
setNames(OPC_col.names) %>%
select(ID, apex.code, apex.input)
Pasture_names_sa20 <- sapply(strsplit(OPC.files_sa20, "_"), function(x) x[3]) %>%
data.frame() %>% mutate(ID = row_number()) %>% rename(Pasture =".")
Pasture_names_sa92_AGM <- sapply(strsplit(OPC.files_sa92_AGM, "_"), function(x) x[3]) %>%
data.frame() %>% mutate(ID = row_number()) %>% rename(Pasture =".")
Pasture_names_sa92_TGM <- sapply(strsplit(OPC.files_sa92_TGM, "_"), function(x) x[3]) %>%
data.frame() %>% mutate(ID = row_number()) %>% rename(Pasture =".")
OPC.input_df_sa20 <- merge(OPC.input_df_sa20, Pasture_names_sa20, by = "ID") %>%
mutate(source = "20 subareas") %>%
select(-ID)
OPC.input_df_sa92_AGM <- merge(OPC.input_df_sa92_AGM, Pasture_names_sa92_AGM, by = "ID") %>%
mutate(source = "92 subareas") %>%
select(-ID)
OPC.input_df_sa92_TGM <- merge(OPC.input_df_sa92_TGM, Pasture_names_sa92_TGM, by = "ID") %>%
mutate(source = "92 subareas") %>%
select(-ID)
OPC.input_df <- rbind(OPC.input_df_sa20, OPC.input_df_sa92_AGM, OPC.input_df_sa92_TGM) %>%
group_by(Pasture, apex.code, source) %>%
summarize(apex.input = round(mean(apex.input), 2)) %>%
pivot_wider(names_from = source, values_from = apex.input) %>%
mutate(diff = `20 subareas` - `92 subareas`)
View(OPC.input_df)
View(OPC.input_df_sa92_TGM)
View(PlantPop_spat_AGM)
View(PlantPop_spat_TGM)
View(OPC.input_df)
OPC.input_df_sa92 <- rbind(OPC.input_df_sa92_AGM, OPC.input_df_sa92_TGM)
OPC.input_sa92 <- OPC.input_sa92 %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
OPC.input_df_sa92 <- rbind(OPC.input_df_sa92_AGM, OPC.input_df_sa92_TGM)
OPC.input_sa92 <- OPC.input_df_sa92 %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
OPC.input_sa92 <- OPC.input_df_sa92 %>%
group_by(apex.code) %>%
summarize(plantPop = mean(apex.input))
## Visualize plant pop differences
ggplot(OPC.input_sa92, aes(fill = apex.code, y = plantPop)) +
geom_bar(position="stack", stat="identity") +
ggtitle("Spatial Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)") +
ylim(0, 30)
View(OPC.input_sa92)
library(tidyverse)
setwd("D:/APEX data and scripts/")
# Import pasture reference information
pastureID <- read.csv("Data/PastureID_ecosite_20subareas.csv") %>%
# Converting pasture name to match CARM name
mutate(Pasture = gsub("10S", "NH", Pasture)) %>%
# Removing unnecessary column
select(-Block)
# Import CARM rotation and stocking density data
cattle.data <- read.csv("Data/CPER Cattle/CARM_ActualGrazingInfov3_2013-2023.csv") %>%
# Removing unnecessary columns
select(PastureCode, Year, Rest, NumSteers, RotationOrder,
DateInPasture, DateOutPasture, split_herd)
library(tidyverse)
setwd("D:/APEX data and scripts/")
# Import pasture reference information
pastureID <- read.csv("Data/PastureID_ecosite_20subareas.csv") %>%
# Converting pasture name to match CARM name
mutate(Pasture = gsub("10S", "NH", Pasture)) %>%
# Removing unnecessary column
select(-Block)
# Import CARM rotation and stocking density data
cattle.data <- read.csv("Data/CPER Cattle/CARM_ActualGrazingInfov4_2013-2023.csv") %>%
# Removing unnecessary columns
select(PastureCode, Year, Rest, NumSteers, RotationOrder,
DateInPasture, DateOutPasture, split_herd)
# Add pasture information & remove pastures that aren't in CARM
cattle.data_merge <- cattle.data %>%
merge(pastureID, by.x = "PastureCode", by.y = "Pasture") %>%
# Calculate ha/animal (input for APEX OPC)
mutate(ha_anim = round((PastureSize_ha / NumSteers), 2))
View(cattle.data_merge)
## Export data
write.csv(cattle.data_merge,"APEX inputs/stocking rate_APEXinputs_2012-2023.csv")
source("D:/APEX data and scripts/R scripts/prepare APEX inputs/plant population_APEX1605.R", echo=TRUE)
View(plant.pop_sa20)
write.csv(plant.pop_sa20, "D:/APEX data and scripts/APEX inputs/input_OPC_subareas20.csv")
###### SUMMARIZING DATA BY PASTURE (20 subareas) ###############################
PastureID_sa20 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv")
##### BASAL AREA ###############################################################
opc.input_basal_sa20 <- merge(basal.area_plot, PastureID_sa20,
by = c("Pasture", "Treatment", "Block"),
all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(meanBasalcoverFG), 2),
fg_min = round(min(meanBasalcoverFG),2),
fg_max = round(max(meanBasalcoverFG),2))
##### SHRUB DENSITY ############################################################
opc.input_shrub_sa20 <- merge(shrub.summ_plot, PastureID_sa20,
by = "Pasture",
all.x = TRUE) %>%
merge(APEX.codes, by.x = "CPNM", by.y = "apex.FG", all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(density), 2),
fg_min = round(min(density),2),
fg_max = round(max(density),2))
##### COMBINE & EXPORT DATA ####################################################
# combine both data types
plant.pop_sa20 <- rbind(opc.input_basal_sa20,opc.input_shrub_sa20)
write.csv(plant.pop_sa20, "D:/APEX data and scripts/APEX inputs/input_OPC_subareas20.csv")
View(opc.input_basal)
View(opc.input_basal_sa20)
opc.input_basal_sa20 <- merge(basal.area_plot, PastureID_sa20,
by = c("Pasture", "Treatment", "Block"),
all.x = TRUE)
View(opc.input_basal)
View(shrub.summ_plot)
###### SUMMARIZING DATA BY PASTURE (20 subareas) ###############################
PastureID_sa20 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv") %>%
mutate(Treatment = ifelse(Treatment == "TGM", "TRM", "CARM"))
##### BASAL AREA ###############################################################
opc.input_basal_sa20 <- merge(basal.area_plot, PastureID_sa20,
by = c("Pasture", "Treatment", "Block"),
all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(meanBasalcoverFG), 2),
fg_min = round(min(meanBasalcoverFG),2),
fg_max = round(max(meanBasalcoverFG),2))
##### SHRUB DENSITY ############################################################
opc.input_shrub_sa20 <- merge(shrub.summ_plot, PastureID_sa20,
by = "Pasture",
all.x = TRUE) %>%
merge(APEX.codes, by.x = "CPNM", by.y = "apex.FG", all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(density), 2),
fg_min = round(min(density),2),
fg_max = round(max(density),2))
##### COMBINE & EXPORT DATA ####################################################
# combine both data types
plant.pop_sa20 <- rbind(opc.input_basal_sa20,opc.input_shrub_sa20)
write.csv(plant.pop_sa20, "D:/APEX data and scripts/APEX inputs/input_OPC_subareas20.csv")
##### SHRUB DENSITY ############################################################
opc.input_shrub_sa20 <- merge(shrub.summ_plot, PastureID_sa20,
by = "Pasture",
all.x = TRUE) %>%
merge(APEX.codes, by.x = "CPNM", by.y = "apex.FG", all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(density), 2),
fg_min = round(min(density),2),
fg_max = round(max(density),2))
View(opc.input_shrub_sa20)
##### COMBINE & EXPORT DATA ####################################################
# combine both data types
plant.pop_sa20 <- rbind(opc.input_basal_sa20,opc.input_shrub_sa20)
##### COMBINE & EXPORT DATA ####################################################
# combine both data types
plant.pop_sa20 <- rbind(opc.input_basal_sa20,opc.input_shrub_sa20)
View(plant.pop_sa20)
write.csv(plant.pop_sa20, "D:/APEX data and scripts/APEX inputs/input_OPC_subareas20.csv")
source("D:/APEX data and scripts/R scripts/prepare APEX inputs/plant population_APEX1605.R", echo=TRUE)
View(opc.input_shrub_sa20)
## Code written by Dr. Sean Di Stefano in 4/2024 for the Central Plains Experimental Range, Nunn, CO
library(tidyverse)
library(rstatix)
setwd("D:/APEX data and scripts/Data")
###### SUMMARIZING DATA BY PLOT (92 subareas) ##################################
PastureID <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
##### BASAL AREA ###############################################################
basal.area <- read.csv("D:/APEX data and scripts/Data/CPER Plant Pop/BasalCover_FuncGrpByTransect_CARM_wide2013-2023.csv") %>%
pivot_longer(cols = BARE:WSPG,
names_to = "FunctionalGroupCode",
values_to = "meanBasalcoverFG") %>%
mutate(Treatment = ifelse(Treatment == "AGM", "CARM", "TRM"))
# renaming NH to 10S
basal.area$Pasture <- gsub(pattern = "NH", replacement = "10S",
x = basal.area$Pasture)
# identify outliers for each functional group
basal.area_outliers <- basal.area %>%
group_by(Ecosite, FunctionalGroupCode) %>%
identify_outliers(meanBasalcoverFG) %>%
dplyr::filter(is.extreme == TRUE)
# remove outliers
basal.area_NOoutliers <- basal.area #%>%
# anti_join(basal.area_outliers)
# adding APEX code
apex.code <- c(300,300,310,321,330,340,351) # functional group code in APEX from CROP.DAT
apex.FG <- c("WSPG", "BOBU", "CSPG", "CSAG", "FORB", "SSHB", "ATCA") # functional group name
APEX.codes <- data.frame(apex.code, apex.FG)
basal.area_plot <- merge(basal.area_NOoutliers, APEX.codes,
by.x = "FunctionalGroupCode",
by.y = "apex.FG",
all.x = TRUE) %>%
filter(Year %in% c(2014:2018) & !(is.na(apex.code)))
# adding info
opc.input_basal <- merge(basal.area_plot, PastureID,
by = c("Pasture", "Treatment","Ecosite",
"Plot", "Block"),
all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(meanBasalcoverFG), 2))
##### SHRUB DENSITY ############################################################
shrub.density <- read.csv("D:/APEX data and scripts/Data/CPER Plant Pop/CARM_shrDensities2013_2023_cln_attr2023-12-28.CSV") %>%
dplyr::rename(Pasture = PASTURE, Plot = PLOT) %>%
dplyr::filter(!(Plot %in% c(5:6) & Pasture %in% c("18S", "19N"))) %>% # removing burn plots
pivot_longer(cols = c(ARFR:KRLA), # shrub functional groups
names_to = "CPNM", values_to = "density")
# renaming NH to 10S
shrub.density$Pasture <- gsub(pattern = "NH", replacement = "10S",
x = shrub.density$Pasture)
# identify outliers for each functional group
shrub.density_outliers <- shrub.density %>%
group_by(Ecosite, CPNM) %>%
identify_outliers(density) #%>%
# dplyr::filter(is.extreme == TRUE)
# remove outliers
shrub.density_NOoutliers <- shrub.density %>%
anti_join(shrub.density_outliers)
# summarizing data to plot
shrub.summ_plot <- shrub.density %>%
# grouping func. groups into SSHB or ATCA
mutate(CPNM = ifelse(CPNM %in% c("ARFR", "EREF", "ERNA", "GUSA", "KRLA", "YUGL"),
"SSHB", "ATCA")) %>%
group_by(YEAR, Pasture, Plot, Ecosite, CPNM) %>%
summarize(density = round(mean(density), 2)) %>%
filter(YEAR %in% c(2014:2018))
# adding pastureID and APEX plant code
opc.input_shrub <- merge(shrub.summ_plot, PastureID,
by = c("Pasture", "Ecosite", "Plot"),
all.x = TRUE) %>%
merge(APEX.codes, by.x = "CPNM", by.y = "apex.FG", all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(density), 2))
##### COMBINE & EXPORT DATA ####################################################
# combine both data types
plant.pop <- rbind(opc.input_basal,opc.input_shrub)
# write.csv(plant.pop, "D:/APEX data and scripts/APEX inputs/input_OPC_subareas92.csv")
###### SUMMARIZING DATA BY PASTURE (20 subareas) ###############################
PastureID_sa20 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv") %>%
mutate(Treatment = ifelse(Treatment == "TGM", "TRM", "CARM"))
##### BASAL AREA ###############################################################
opc.input_basal_sa20 <- merge(basal.area_plot, PastureID_sa20,
by = c("Pasture", "Treatment", "Block"),
all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(meanBasalcoverFG), 2),
fg_min = round(min(meanBasalcoverFG),2),
fg_max = round(max(meanBasalcoverFG),2))
##### SHRUB DENSITY ############################################################
opc.input_shrub_sa20 <- merge(shrub.summ_plot, PastureID_sa20,
by = "Pasture",
all.x = TRUE) %>%
merge(APEX.codes, by.x = "CPNM", by.y = "apex.FG", all.x = TRUE) %>%
group_by(ID, Treatment, apex.code) %>%
summarize(apex.input = round(mean(density), 2),
fg_min = round(min(density),2),
fg_max = round(max(density),2))
View(shrub.summ_plot)
View(PastureID_sa20)
source("D:/APEX data and scripts/R scripts/prepare APEX inputs/compare_OPC inputs.R", echo=TRUE)
source("D:/APEX data and scripts/R scripts/check plant pop.R", echo=TRUE)
source("D:/APEX data and scripts/R scripts/check plant pop.R", echo=TRUE)
name.cag <- c("N", "ID", "Y", "M", "D", "CPNM", "WSAha","Grazed.1", "Grazed.2",
"Grazed.3","HUI", "LAI", "RD", "RW","BIOM", "STL", "CPHT", "STD",
"STDL", "GZSL", "GZSD", "A_DDM", "PRCP", "PET", "AET", "AT", "AE",
"Q", "AT.SP", "WS", "NS", "TS", "MIN_STRESS", "SURF_LIT",
"TOTAL_LIT", "POP", "STL_N", "STD_N")
pathAGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
PlantPop_spat_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct() %>%
mutate(Treatment = "CARM")
PlantPop_spat_TGM <- fread(pathTGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()  %>%
mutate(Treatment = "TRM")
PlantPop_spat <- rbind(PlantPop_spat_AGM, PlantPop_spat_TGM)
# Step 3: Spatial + Temporal Variability simulation
pathAGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_AGM_cagebm/CONUNN_TGM.cag"
pathTGM <- "D:/02-APEX1605_spatialtemp/APEX1605_CO_92 subareas_div_dyn plant pop/APEX1605_CO_TGM_cagebm/CONUNN_TGM.cag"
PlantPop_spatTemp_AGM <- fread(pathAGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct() %>%
mutate(Treatment = "CARM")
PlantPop_spatTemp_TGM <- fread(pathTGM, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2022) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()  %>%
mutate(Treatment = "TRM")
PlantPop_spatTemp <- rbind(PlantPop_spatTemp_AGM, PlantPop_spatTemp_TGM)
# Import pasture reference information
PastureID_sa20 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_20subareas.csv")
PastureID_sa92 <- read.csv("D:/APEX data and scripts/Data/PastureID_ecosite_92subareas.csv")
# Add in reference info
PlantPop_yr_base <- merge(PlantPop_base, PastureID_sa20, by = "ID") %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
PlantPop_yr_spat <- merge(PlantPop_spat, PastureID_sa92, by = c("ID", "Treatment")) %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
PlantPop_yr_spatTemp <- merge(PlantPop_spatTemp, PastureID_sa92, by = c("ID", "Treatment")) %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
## Visualize plant pop differences
ggplot(PlantPop_yr_base, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)") +
ylim(0, 30)
name.cag <- c("N", "ID", "Y", "M", "D", "CPNM", "WSAha","Grazed.1", "Grazed.2",
"Grazed.3","HUI", "LAI", "RD", "RW","BIOM", "STL", "CPHT", "STD",
"STDL", "GZSL", "GZSD", "A_DDM", "PRCP", "PET", "AET", "AT", "AE",
"Q", "AT.SP", "WS", "NS", "TS", "MIN_STRESS", "SURF_LIT",
"TOTAL_LIT", "POP", "STL_N", "STD_N", "Surface")
## Import population data
# Step 1: Baseline simulation
path <- "D:/01-APEX1605_CO_baseline/APEX1605_CO_all20_cagebm/CONUNN_TGM.cag"
PlantPop_base <- fread(path, header = FALSE, skip = 2,
col.names = name.cag, fill = TRUE) %>%
filter(Y %in% c(2014:2023) &
CPNM %in% c("WSPG", "CSPG", "VUOC", "FRB3")) %>%
select(ID, Y, CPNM, POP) %>%
distinct()
# Add in reference info
PlantPop_yr_base <- merge(PlantPop_base, PastureID_sa20, by = "ID") %>%
group_by(Y, CPNM) %>%
summarize(plantPop = mean(POP))
## Visualize plant pop differences
ggplot(PlantPop_yr_base, aes(fill = CPNM, y = plantPop, x = factor(Y))) +
geom_bar(position="stack", stat="identity") +
ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
ylab("Herbaceous Plant Pop (Basal Area %)") +
ylim(0, 30)
source("D:/APEX data and scripts/R scripts/prepare APEX inputs/compare_OPC inputs.R", echo=TRUE)
View(OPC.input_df)
source("D:/APEX data and scripts/R scripts/check plant pop.R", echo=TRUE)
