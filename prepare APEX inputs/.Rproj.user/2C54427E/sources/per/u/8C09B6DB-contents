PlantPop_yr_base <- merge(PlantPop_base, PastureID_sa20, by = "ID") %>%
  group_by(CPNM, Treatment) %>%
  summarize(plantPop = mean(POP))

PlantPop_yr_base$CPNM <- gsub(PlantPop_yr_base$CPNM, pattern = "FRB3", replacement = "FORB")
PlantPop_yr_base$CPNM <- gsub(PlantPop_yr_base$CPNM, pattern = "VUOC", replacement = "CSAG")

PlantPop_yr_spat <- merge(PlantPop_spat, PastureID_sa92, by = c("ID", "Treatment")) %>%
  group_by(CPNM, Treatment, Pasture) %>%
  summarize(plantPop = mean(POP)) 

PlantPop_yr_spat$CPNM <- gsub(PlantPop_yr_spat$CPNM, pattern = "FRB3", replacement = "FORB")
PlantPop_yr_spat$CPNM <- gsub(PlantPop_yr_spat$CPNM, pattern = "VUOC", replacement = "CSAG")

ggplot(PlantPop_yr_spat, aes(fill = CPNM, y = plantPop, x = Pasture)) +
  geom_bar(position="stack", stat="identity") +
  # ggtitle("Baseline Simulation Plant Pop - Herbaceous") +
  ylab("Herbaceous Plant Pop (Basal Area %)") +
  xlab("Pasture") +
  ylim(0, 30) +
  theme_bw() +
  theme(text = element_text(size = 15, family = 'serif'),
        axis.text.x = element_text(angle = 90)) +
  scale_fill_brewer(palette = "Set2", type = "qual",
                    name = "Functional Group")
